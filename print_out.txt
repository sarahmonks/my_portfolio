
app/controllers/contacts_controller.rb
class ContactsController < ApplicationController
    def new
        @contact = Contact.new
    end

    def create 
        @contact = Contact.new(contact_params)
        if @contact.valid?
    
            if ContactMailer.contact_me(@contact).deliver_now
                flash.now[:notice] = 'Thank you for your message. I will contact you soon!'
            else
                flash.now[:error] = 'There was a problem sending your message. Please try again!'
                render :new
            end
    	else
      		render :new
    	end
    end

    private
    def contact_params
        params.require(:contact).permit(:first_name, :last_name, :email, :phone_number, :message)

    end
end



app/mailers/contact_mailer.rb
class ContactMailer < ApplicationMailer

  # Subject can be set in your I18n file at config/locales/en.yml
  # with the following lookup:
  #
  #   en.contact_mailer.contact_me.subject
  #
  def contact_me(message)
      @body = message.message
      @first_name = message.first_name
      @last_name = message.last_name
      @phone_number = message.phone_number
      @email = message.email
      mail to: "monks.sarah@gmail.com", from: message.email
  end
end


config/locales/en.yml
en:
  hello: "Hello world"
  contact_mailer:
    contact_me:
      subject: "Sarah Monks Contact Form"



environments/production.rb
config.action_mailer.perform_caching = false
config.action_mailer.perform_deliveries = true
config.action_mailer.raise_delivery_errors = true

config.action_mailer.delivery_method = :smtp
config.action_mailer.smtp_settings = {
  address:              'smtp.gmail.com',
  port:                 587,
  domain:               'gmail.com',
  user_name:            'monks.sarah@gmail.com',
  password:             '5275_3268Sm',
  authentication:       'plain',
  enable_starttls_auto: true }

config.action_mailer.default_url_options = { :host => "localhost:3000" }




app/views/contact_me.html.erb
<p>First name: <%= @first_name %></p>
<p>Last name: <%= @last_name %></p>
<p>Phone number: <%= @phone_number %></p>
<p>Email: <%= @email %></p>
<p>Message: </p>
<%= @body %>